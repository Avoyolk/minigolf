<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jesse's Golf: Chicken Banana Edition</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #2c3e50;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif; /* Fun font */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            touch-action: none;
        }

        #gameContainer {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: 600px; /* Portrait aspect limit */
            background: #2c3e50;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: #4cd137;
        }

        /* HUD */
        .ui-layer {
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            color: white;
            font-weight: bold;
            font-size: 20px;
            z-index: 10;
            text-shadow: 2px 2px 0px #000;
        }

        .badge {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            border-radius: 15px;
            border: 2px solid white;
        }

        /* Popups */
        #message-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            z-index: 20;
            backdrop-filter: blur(5px);
            text-align: center;
        }

        button {
            background: #f1c40f;
            border: 4px solid #fff;
            padding: 15px 40px;
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:active { transform: scale(0.95); }
    </style>
</head>
<body>

    <div id="gameContainer">
        <div class="ui-layer">
            <div class="badge">ðŸ‘¤ JESSE</div>
            <div class="badge" id="level-indicator">Level 1</div>
        </div>

        <div id="message-overlay">
            <h1 id="message-title" style="font-size: 40px; margin: 0;">HOLE IN ONE!</h1>
            <p id="message-sub" style="font-size: 20px;">Great Shot!</p>
            <button id="nextBtn">NEXT LEVEL â–¶</button>
        </div>

        <canvas id="gameCanvas" width="600" height="900"></canvas>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const levelText = document.getElementById('level-indicator');
    const msgOverlay = document.getElementById('message-overlay');
    const msgTitle = document.getElementById('message-title');
    const nextBtn = document.getElementById('nextBtn');

    // --- Assets ---
    // Grass Pattern
    const grassPattern = (() => {
        const c = document.createElement('canvas');
        c.width = 64; c.height = 64;
        const x = c.getContext('2d');
        x.fillStyle = '#44bd32'; x.fillRect(0,0,64,64);
        x.fillStyle = '#4cd137'; x.globalAlpha = 0.4;
        x.beginPath(); x.arc(32,32,10,0,Math.PI*2); x.fill();
        return ctx.createPattern(c, 'repeat');
    })();

    // --- Game Variables ---
    let currentLevelIdx = 0;
    let strokes = 0;
    let gameState = 'PLAYING';
    
    // Physics
    let isDragging = false;
    let dragStart = {x:0, y:0};
    let dragCurrent = {x:0, y:0};
    const FRICTION = 0.96;
    const POWER_SCALE = 0.25; // More power for bigger screen
    const MAX_POWER = 35;
    
    // Objects
    // BIGGER BALL for Jesse (Radius 18)
    let ball = { x: 300, y: 800, r: 18, vx: 0, vy: 0 }; 
    let hole = { x: 300, y: 100, r: 22 }; // Bigger hole too
    let walls = [];
    let chickens = []; // Array for Chicken Bananas

    // --- The 20 Levels (Portrait Mode: Width 600, Height 900) ---
    // 0,0 is Top-Left. 600,900 is Bottom-Right.
    // Ball usually starts at bottom (y=800), Hole at top (y=100)
    const levels = [];

    // Helper to add levels easily
    function addLevel(bX, bY, hX, hY, wallData, chickenData = []) {
        levels.push({
            ball: {x: bX, y: bY},
            hole: {x: hX, y: hY},
            walls: wallData,
            chickens: chickenData
        });
    }

    // 1. Straight Shot
    addLevel(300, 800, 300, 150, [
        {x: 150, y: 400, w: 20, h: 200}, {x: 430, y: 400, w: 20, h: 200}
    ]);
    
    // 2. The Gate
    addLevel(300, 800, 300, 100, [
        {x: 0, y: 450, w: 250, h: 30}, {x: 350, y: 450, w: 250, h: 30}
    ]);

    // 3. Chicken Introduction (One Chicken Banana)
    addLevel(300, 800, 300, 100, [], [{x: 300, y: 450, r: 40}]);

    // 4. Zig Zag Walls
    addLevel(100, 800, 500, 100, [
        {x: 0, y: 600, w: 400, h: 20},
        {x: 200, y: 300, w: 400, h: 20}
    ]);

    // 5. Chicken Army
    addLevel(300, 800, 300, 100, [], [
        {x: 150, y: 300, r: 35}, {x: 450, y: 300, r: 35},
        {x: 300, y: 500, r: 35}
    ]);

    // 6. The Box
    addLevel(300, 800, 300, 450, [
        {x: 200, y: 350, w: 200, h: 20}, // Top
        {x: 200, y: 550, w: 200, h: 20}, // Bottom
        {x: 200, y: 350, w: 20, h: 220}, // Left
        {x: 380, y: 350, w: 20, h: 80},  // Right Top
        {x: 380, y: 490, w: 20, h: 80}   // Right Bottom
    ]);

    // 7. Long Shot
    addLevel(100, 850, 500, 50, [
        {x: 290, y: 100, w: 20, h: 700}
    ]);

    // 8. Chicken Guard
    addLevel(300, 800, 300, 100, [
        {x: 200, y: 200, w: 20, h: 100}, {x: 380, y: 200, w: 20, h: 100}
    ], [{x: 300, y: 250, r: 30}]);

    // 9. Diagonal Feel
    addLevel(100, 800, 500, 100, [
        {x: 100, y: 600, w: 200, h: 20},
        {x: 300, y: 400, w: 200, h: 20},
        {x: 100, y: 200, w: 200, h: 20}
    ]);

    // 10. Tunnel
    addLevel(300, 850, 300, 50, [
        {x: 250, y: 0, w: 20, h: 900}, {x: 330, y: 0, w: 20, h: 900}
    ]);

    // 11-20 Rapid Fire Levels
    addLevel(500, 800, 100, 100, [], [{x: 300, y: 450, r: 60}]); // Giant Chicken
    addLevel(300, 800, 300, 100, [{x:0, y:400, w:600, h:20}]); // Simple Wall
    addLevel(300, 500, 300, 200, [{x:200, y:300, w:200, h:20}, {x:200, y:300, w:20, h:200}, {x:400, y:300, w:20, h:200}]); // U Shape
    addLevel(100, 800, 500, 100, [], [{x:200, y:600, r:30}, {x:400, y:400, r:30}, {x:200, y:200, r:30}]); // 3 Chickens
    addLevel(300, 800, 300, 100, [{x:100, y:300, w:400, h:20}, {x:100, y:600, w:400, h:20}]); // Two Bars
    addLevel(50, 500, 550, 500, [{x:300, y:100, w:20, h:700}]); // Vertical Split
    addLevel(300, 800, 300, 100, [], [{x:150, y:300, r:30}, {x:450, y:300, r:30}, {x:150, y:600, r:30}, {x:450, y:600, r:30}]); // 4 Corners
    addLevel(300, 800, 300, 100, [{x:250, y:300, w:100, h:300}]); // Solid Block
    addLevel(100, 100, 500, 800, [{x:0,y:450,w:400,h:20}], [{x:500, y:450, r:40}]); // Reverse
    addLevel(300, 800, 300, 100, [], [{x:300,y:450,r:20}, {x:300,y:350,r:20}, {x:300,y:250,r:20}, {x:300,y:550,r:20}]); // Line of Chickens

    // --- Logic ---
    function loadLevel(idx) {
        if(idx >= levels.length) {
            msgTitle.innerText = "ðŸ† YOU WIN!";
            document.getElementById('message-sub').innerText = "Jesse is the Golf Master!";
            nextBtn.innerText = "PLAY AGAIN";
            nextBtn.onclick = () => { currentLevelIdx=0; loadLevel(0); };
            msgOverlay.style.display = 'flex';
            return;
        }
        
        const d = levels[idx];
        ball.x = d.ball.x; ball.y = d.ball.y;
        ball.vx = 0; ball.vy = 0;
        hole.x = d.hole.x; hole.y = d.hole.y;
        walls = d.walls;
        chickens = d.chickens || [];
        
        strokes = 0;
        gameState = 'PLAYING';
        levelText.innerText = `Level ${idx+1} / 20`;
        msgOverlay.style.display = 'none';
    }

    // Input Handling
    function getPos(e) {
        const r = canvas.getBoundingClientRect();
        const sx = canvas.width / r.width;
        const sy = canvas.height / r.height;
        let cx = e.clientX, cy = e.clientY;
        if(e.touches && e.touches.length) { cx=e.touches[0].clientX; cy=e.touches[0].clientY; }
        return { x: (cx-r.left)*sx, y: (cy-r.top)*sy };
    }

    function start(e) {
        if(Math.abs(ball.vx)<0.1 && Math.abs(ball.vy)<0.1) {
            isDragging=true;
            dragStart = getPos(e);
            dragCurrent = dragStart;
        }
    }
    function move(e) {
        if(isDragging) {
            if(e.cancelable) e.preventDefault();
            dragCurrent = getPos(e);
        }
    }
    function end() {
        if(isDragging) {
            isDragging=false;
            let dx = dragStart.x - dragCurrent.x;
            let dy = dragStart.y - dragCurrent.y;
            ball.vx = dx * POWER_SCALE;
            ball.vy = dy * POWER_SCALE;
            
            // Speed Cap
            let s = Math.sqrt(ball.vx**2 + ball.vy**2);
            if(s > MAX_POWER) {
                ball.vx *= (MAX_POWER/s);
                ball.vy *= (MAX_POWER/s);
            }
            if(s > 1) strokes++;
        }
    }

    canvas.addEventListener('mousedown', start);
    canvas.addEventListener('mousemove', move);
    window.addEventListener('mouseup', end);
    canvas.addEventListener('touchstart', start, {passive:false});
    canvas.addEventListener('touchmove', move, {passive:false});
    window.addEventListener('touchend', end);

    function update() {
        if(gameState !== 'PLAYING') return;

        ball.x += ball.vx; ball.y += ball.vy;
        ball.vx *= FRICTION; ball.vy *= FRICTION;
        if(Math.abs(ball.vx)<0.1) ball.vx=0;
        if(Math.abs(ball.vy)<0.1) ball.vy=0;

        // Wall Bounce
        if(ball.x<ball.r) { ball.x=ball.r; ball.vx*=-0.8; }
        if(ball.x>canvas.width-ball.r) { ball.x=canvas.width-ball.r; ball.vx*=-0.8; }
        if(ball.y<ball.r) { ball.y=ball.r; ball.vy*=-0.8; }
        if(ball.y>canvas.height-ball.r) { ball.y=canvas.height-ball.r; ball.vy*=-0.8; }

        // Obstacles (Walls)
        walls.forEach(w => {
            // AABB vs Circle
            let cx = Math.max(w.x, Math.min(ball.x, w.x+w.w));
            let cy = Math.max(w.y, Math.min(ball.y, w.y+w.h));
            let dx = ball.x - cx, dy = ball.y - cy;
            let dist = Math.sqrt(dx*dx + dy*dy);
            if(dist < ball.r) {
                // Bounce
                if(Math.abs(dx) > Math.abs(dy)) ball.vx *= -1;
                else ball.vy *= -1;
                // Push out
                let pen = ball.r - dist;
                let angle = Math.atan2(dy, dx);
                ball.x += Math.cos(angle)*pen;
                ball.y += Math.sin(angle)*pen;
            }
        });

        // Obstacles (Chickens - Circular)
        chickens.forEach(c => {
            let dx = ball.x - c.x;
            let dy = ball.y - c.y;
            let dist = Math.sqrt(dx*dx + dy*dy);
            let minDist = c.r + ball.r;
            if(dist < minDist) {
                // Bounce off Chicken
                let angle = Math.atan2(dy, dx);
                let tx = c.x + Math.cos(angle) * minDist;
                let ty = c.y + Math.sin(angle) * minDist;
                
                // Elastic bounce
                let ax = (tx - ball.x) * 0.1;
                let ay = (ty - ball.y) * 0.1;
                ball.vx -= ax;
                ball.vy -= ay;
                ball.vx *= -0.9;
                ball.vy *= -0.9;
                
                // Push out directly
                ball.x = tx;
                ball.y = ty;
            }
        });

        // Win
        let dh = Math.sqrt((ball.x-hole.x)**2 + (ball.y-hole.y)**2);
        let s = Math.sqrt(ball.vx**2+ball.vy**2);
        if(dh < hole.r && s < 10) {
            gameState = 'WON';
            ball.vx=0; ball.vy=0; ball.x=hole.x; ball.y=hole.y;
            setTimeout(() => {
                msgTitle.innerText = "HOLE IN ONE!";
                document.getElementById('message-sub').innerText = `Strokes: ${strokes}`;
                nextBtn.onclick = () => { currentLevelIdx++; loadLevel(currentLevelIdx); };
                msgOverlay.style.display = 'flex';
            }, 200);
        }
    }

    // --- Drawing The Chicken Banana ---
    function drawChickenBanana(x, y, r) {
        // 1. The Chicken Body (White Circle)
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI*2);
        ctx.fillStyle = '#fff';
        ctx.fill();
        ctx.strokeStyle = '#ccc'; ctx.lineWidth=2; ctx.stroke();

        // 2. The Banana Head (Yellow Crescent)
        // Position on top
        ctx.save();
        ctx.translate(x, y - r/2);
        ctx.rotate(-0.2);
        
        // Banana shape
        ctx.beginPath();
        ctx.arc(0, -5, r*0.6, 0.5, 2.6); // Inner curve
        ctx.bezierCurveTo(-r*0.8, -r*0.5, r*0.8, -r*0.5, r*0.3, 2); // Outer curve
        ctx.fillStyle = '#f1c40f'; // Banana Yellow
        ctx.fill();
        ctx.lineWidth = 1; ctx.strokeStyle = '#d35400'; ctx.stroke();
        
        // Eye (on the banana)
        ctx.beginPath(); ctx.arc(-5, -5, 2, 0, Math.PI*2); ctx.fillStyle='black'; ctx.fill();

        // Beak
        ctx.beginPath();
        ctx.moveTo(-10, 0); ctx.lineTo(-18, 4); ctx.lineTo(-10, 8);
        ctx.fillStyle = '#e67e22'; ctx.fill();
        
        ctx.restore();
        
        // 3. Chicken Feet
        ctx.beginPath();
        ctx.moveTo(x-10, y+r-5); ctx.lineTo(x-15, y+r+5);
        ctx.moveTo(x+10, y+r-5); ctx.lineTo(x+15, y+r+5);
        ctx.lineWidth = 3; ctx.strokeStyle = '#e67e22'; ctx.stroke();
    }

    function draw() {
        // Clear
        ctx.fillStyle = grassPattern;
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // Hole
        ctx.beginPath(); ctx.arc(hole.x, hole.y, hole.r, 0, Math.PI*2);
        ctx.fillStyle = '#111'; ctx.fill(); 
        ctx.strokeStyle='rgba(255,255,255,0.2)'; ctx.lineWidth=4; ctx.stroke();

        // Walls
        ctx.fillStyle = '#8d6e63';
        walls.forEach(w => {
            ctx.fillRect(w.x, w.y, w.w, w.h);
            ctx.strokeStyle='#5d4037'; ctx.lineWidth=3; ctx.strokeRect(w.x,w.y,w.w,w.h);
        });

        // Chickens
        chickens.forEach(c => {
            drawChickenBanana(c.x, c.y, c.r);
        });

        // Drag Line
        if(isDragging) {
            let dx = dragStart.x - dragCurrent.x;
            let dy = dragStart.y - dragCurrent.y;
            ctx.beginPath();
            ctx.moveTo(ball.x, ball.y);
            ctx.lineTo(ball.x+dx, ball.y+dy);
            ctx.strokeStyle = 'white'; ctx.lineWidth=5; ctx.setLineDash([10,10]); ctx.stroke(); ctx.setLineDash([]);
        }

        // BIG BALL
        ctx.beginPath(); ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
        let g = ctx.createRadialGradient(ball.x-5, ball.y-5, 2, ball.x, ball.y, ball.r);
        g.addColorStop(0, 'white'); g.addColorStop(1, '#bdc3c7');
        ctx.fillStyle = g; ctx.fill();
        ctx.strokeStyle='#7f8c8d'; ctx.lineWidth=2; ctx.stroke();
    }

    function loop() { update(); draw(); requestAnimationFrame(loop); }
    loadLevel(0);
    loop();
</script>
</body>
</html>
